
(function(a){"use strict",a.Socked={}})(window),function(a,b){"use strict",b.Logger={log:function(){var b=arguments.length,c=[];for(var d=0;d<b;d+=1)c[d]=arguments[d];typeof a.console!="undefined"&&a.console.log(c)}}}(window,window.Socked),function(a){"use strict",a.ChannelRef=function(a,b){var c=this;this.onConnect=null,this.onMessage=null,this.onDisconnect=null,this.options={role:"sender",interests:null},this.onConnect=function(a){return c.onConnect=a,c},this.onMessage=function(a){return c.onMessage=a,c},this.onDisconnect=function(a){return c.onDisconnect=a,c},this.send=function(b){if(a!==null){if(c.options.role==="receiver")return;a.send(b)}},this.unsubscribe=function(){a!==null&&a.unsubscribe(c)},this.reSubscribe=function(d){a!==null&&b(c,d)}}}(window.Socked),function(a){"use strict";var b=a.ChannelRef;a.Channel=function(a,c){var d=this,e=a.name,f=[],g=function(a){return a+1},h=function(a){return a-1},i=function(){c.connectToChannel(e)},j=function(){c.disconnectFromChannel(e)},k=function(a,b){a.options=b,f.length===0&&i();var d=w(b,g);d===!0&&c.updateChannelSubscription(e,o,t),f.push(a)},l=0,m=0,n="sender",o=n,p=function(a,b){a!=="sender"&&(m=b(m)),a!=="receiver"&&(l=b(l))},q=function(a,b){p(a,b);var c=n;return l>0&&m>0?c="both":l>0?c="sender":m>0&&(c="receiver"),c!==o?(o=c,!0):!1},r=0,s={},t=null,u=function(a,b){if(a===null){r=b(r);return}var c=a.length;for(var d=0;d<c;d+=1){var e=a[d],f=s[e]||0;f=b(f),f===0?delete s[e]:s[e]=f}},v=function(a,b){u(a,b);if(r>0)return t!==null?(t=null,!0):!1;var c=[],d=0;for(var e in s)s.hasOwnProperty(e)&&(c.push(e),d+=1);if(d===0)return t=null,!0;if(t===null)return t=c.sort(),!0;c.sort();var f=t.length;if(d===f){var g=0;for(;g<d;g+=1)if(c[g]!==t[g])break;if(g===d)return!1}return t=c,!0},w=function(a,b){var c=a.role,d=q(c,b),e=a.interests||null,f=v(e,b);return d||f};this.subscribe=function(a){var c=function(a,b){k(a,b)},e=new b(d,c);return k(e,a),e},this.unsubscribe=function(a){var b=f.indexOf(a);b!==-1&&f.splice(b),a.onDisconnect(),f.length===0&&j();var d=a.options,g=w(d,h);g===!0&&c.updateChannelSubscription(e,o,t)},this.onConnect=function(){var a=f.length;for(var b=0;b<a;b+=1){var c=f[b];c.onConnect!==null&&c.onConnect()}},this.onMessage=function(a){var b=f.length;for(var c=0;c<b;c+=1){var d=f[c];if(d.onMessage!==null){if(d.options.role==="sender")continue;if(typeof a.action!="undefined"){var e=a.action,g=d.options.interests||null;if(g!==null){var h=g.length,i=!1;for(var j=0;j<h;j+=1)if(g[j]===e){i=!0;break}if(!i)continue}}d.onMessage(a)}}},this.onDisconnect=function(){var a=f.length;for(var b=0;b<a;b+=1){var c=f[b];c.onDisconnect!==null&&c.onDisconnect()}},this.send=function(a){c.sendToChannel(e,a)}}}(window.Socked),function(a,b){"use strict";if(typeof a.SockJS=="undefined"){b.Connection=function(){throw"SockJS not available"};return}var c=b.Channel,d=b.Logger;b.Connection=function(b){var d=[],e=b.appKey,f={};for(var g=0;g<b.channels.length;g+=1){var h=b.channels[g],i=new c(h,this),j=h.name;f[j]=i}var k=function(a){d.push(a)},l=function(a){},m=function(a){},n=function(){for(var a=0;a<d.length;a+=1)l(d[a]);d=[]};this.getId=function(){return b===null?"":b.id},this.getChannel=function(a){return f[a]||null};var o=function(a,b,c){var d=p.getChannel(a);d!==null&&(b==="s"?d.onConnect():b==="u"?d.onDisconnect():d.onMessage(c))},p=this,q=null,r="s",s="us",t="u",u="m";this.isConnected=function(){return q!==null};var v=function(){q=null};l=function(a){q!==null&&(a=JSON.stringify(a),q.send(a))},m=function(a){q!==null?l(a):k(a)};var w={onopen:function(){},onmessage:function(a){var b=JSON.parse(a.data),c=b.shift(),d=b.shift(),e=b.shift();o(c,d,e)},onclose:function(){v()}},x=function(b,c,d){var e="http://"+b+"/sockjs",f=new a.SockJS(e);f.onopen=function(){f.onmessage=w.onmessage,f.onopen=w.onopen,f.onclose=w.onclose,c(f)},f.onclose=function(){var a="Connection closed.";d(a)}},y=function(){var a=[e];l(a)};this.connect=function(a,c){if(q!==null){a(p);return}var d=b.server;x(d,function(b){q=b,y(),n(),a(p)},function(a){q=null,c(a)})},this.disconnect=function(){q!==null&&(q.close(),q=null)},this.connectToChannel=function(a){var b=[a,r];m(b)},this.disconnectFromChannel=function(a){var b=[a,t];m(b)},this.sendToChannel=function(a,b){var c=[a,u,b];m(c)},this.updateChannelSubscription=function(a,b,c){var d=[a,s,b];if(c!==null){var e=[],f=c.length;for(var g=0;g<f;g+=1)e[g]=c[g];d[3]=e}m(d)}}}(window,window.Socked),function(a){"use strict";var b=a.Logger,c=a.Connection;a.Transport=function(){var a={},d=function(a,c){c.connect(function(){b.log("Socked: connection "+a+" established!")},function(c){var d="Connection "+a+"#connect() failed due to "+c;b.log(d)})};this.createConnection=function(b){var e=b.id,f=a[e]||null;return f===null&&(f=new c(b),a[e]=f,d(e,f)),f},this.getConnection=function(b){return a[b]||null}}}(window.Socked),function(a,b){"use strict";var c=b.Logger,d=b.Transport,e=function(a){if(typeof a=="function")try{a()}catch(b){c.log("Error on Socked.ready(): ",b)}},f=new d,g=function(a){return f.createConnection(a)},h=function(a,b){var c=f.getConnection(a);return c===null?null:c.getChannel(b)},i=function(a,b,c){var d=h(a,b);return d===null?null:d.subscribe(c)};a.Socked={ready:e,createConnection:g,getChannel:h,subscribe:i}}(window,window.Socked)